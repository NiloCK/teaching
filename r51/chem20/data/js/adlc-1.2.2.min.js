/*global document, navigator, location, window, frames, XMLHttpRequest, ActiveXObject, XSLTProcessor, XMLHttpRequest, XDomainRequest, XMLSerializer, alert */
var adlcJS=(function()
{"use strict";var base=this;var isIE=(navigator.appName==="Microsoft Internet Explorer")?true:false;function isOffline()
{return(location.protocol!=="http:"&&location.protocol!=="https:");}
function fireEvent(element,event)
{var evt;if(document.createEventObject)
{evt=document.createEventObject();return element.fireEvent('on'+event,evt);}
else
{evt=document.createEvent("HTMLEvents");evt.initEvent(event,true,true);return!element.dispatchEvent(evt);}}
function getUniqueLocalConnectionId()
{return String(Math.random()).substring(2)+String(new Date().getTime());}
function getFlash(id)
{return isIE?window[id]:document[id];}
function getFrame(id)
{var el=document.getElementById(id);return el?el:frames[id];}
function iframebuster(id)
{var iframe=getFrame(id);var uri="about:blank";if(iframe.src){iframe.src=uri;}
else if(iframe.location&&iframe.location.href){iframe.location.href=uri;}
else if(iframe.location){iframe.location=uri;}
else{iframe.innerHTML="";}}
function cachebuster()
{return String(new Date().getTime());}
function changeCSS(theClass,element,value)
{var cssRules,added=false;var oStyle,oRule,s,r,rules;var styles=document.styleSheets.length;if(document.all){cssRules='rules';}
else if(document.getElementById){cssRules='cssRules';}
for(s=0;s<styles;s++)
{oStyle=document.styleSheets[s];rules=oStyle[cssRules].length;for(r=0;r<rules;r++)
{oRule=oStyle[cssRules][r];if(oRule.selectorText===theClass)
{if(oRule.style[element])
{oRule.style[element]=value;added=true;break;}}}
if(!added)
{if(oStyle.insertRule)
{oStyle.insertRule(theClass+' { '+element+': '+value+'; }',oStyle[cssRules].length);}
else if(oStyle.addRule)
{oStyle.addRule(theClass,element+': '+value+';');}}}}
function xdr()
{var transport;if(typeof XMLHttpRequest!=="undefined")
{transport=new XMLHttpRequest();if(transport.withCredentials===undefined&&typeof XDomainRequest!=="undefined"){transport=new XDomainRequest();}}
return transport;}
function xhr()
{var transport;if(!isOffline())
{if(typeof XMLHttpRequest!=="undefined")
{transport=new XMLHttpRequest();}}
else if(window.ActiveXObject)
{try{transport=new ActiveXObject("Msxml2.XMLHTTP.6.0");}
catch(e){try{transport=new ActiveXObject("Msxml2.XMLHTTP.3.0");}
catch(e2){transport=new ActiveXObject("Msxml2.XMLHTTP");}}}
return transport;}
function runTransform(xmlFile,xslFile,xDoc)
{if(document.implementation&&document.implementation.createDocument)
{var xsltProcessor=new XSLTProcessor();var myXMLHTTPRequest=new XMLHttpRequest();myXMLHTTPRequest.open("GET",xslFile,false);myXMLHTTPRequest.send(null);var xslStylesheet=myXMLHTTPRequest.responseXML;xsltProcessor.importStylesheet(xslStylesheet);myXMLHTTPRequest=new XMLHttpRequest();myXMLHTTPRequest.open("GET",xmlFile,false);myXMLHTTPRequest.send(null);var xmlSource=myXMLHTTPRequest.responseXML;var result=xsltProcessor.transformToDocument(xmlSource);var xmls=new XMLSerializer();var output=xmls.serializeToString(result);xDoc.document.close();xDoc.document.open();xDoc.document.write(output);}
else if(window.ActiveXObject)
{var xml=new ActiveXObject("MSXML2.DOMDocument");xml.async=false;xml.load(xmlFile);var xsl=new ActiveXObject("MSXML2.DOMDocument");xsl.async=false;xsl.load(xslFile);xDoc.document.write(xml.transformNode(xsl));}
else
{alert("Browser unknown");}}
function addEvent(obj,type,fn)
{if(obj.addEventListener)
{obj.addEventListener(type,fn,false);}
else if(obj.attachEvent)
{obj["e"+type+fn]=fn;obj[type+fn]=function(){obj["e"+type+fn](window.event);};obj.attachEvent("on"+type,obj[type+fn]);}}
function removeEvent(obj,type,fn)
{if(obj.removeEventListener)
{obj.removeEventListener(type,fn,false);}
else if(obj.detachEvent)
{obj.detachEvent("on"+type,obj[type+fn]);obj[type+fn]=null;obj["e"+type+fn]=null;}}
function addWindowEvent(strEvent,oFunction,bCapture)
{var oldOnLoad=window.onload;var eFunction=function()
{if(oldOnLoad){oldOnLoad();}
oFunction();};if(window.addEventListener){window.addEventListener(strEvent,eFunction,bCapture);}else if(window.attachEvent){window.attachEvent(("on"+strEvent),eFunction);}}
function getMouseXY(e)
{e=e||window.event;var cursor={x:0,y:0};if(e.pageX||e.pageY)
{cursor.x=e.pageX;cursor.y=e.pageY;}
else if(e.clientX||e.clientY)
{cursor.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;cursor.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop;}
return cursor;}
function getElementPosX(obj){return(obj.offsetLeft+((obj.offsetParent)?getElementPosX(obj.offsetParent):0));}
function getElementPosY(obj){return(obj.offsetTop+((obj.offsetParent)?getElementPosY(obj.offsetParent):0));}
function openWin(page,name,prop)
{var paramstring="",obj;for(obj in prop)
{if(prop.hasOwnProperty(obj)){paramstring+=obj+'='+prop[obj]+',';}}
return window.open(page,name,paramstring.substring(0,paramstring.length-1));}
function getWindowSize()
{var w=0,h=0;if(typeof(window.innerWidth)==='number'){w=window.innerWidth;h=window.innerHeight;}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){w=document.documentElement.clientWidth;h=document.documentElement.clientHeight;}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){w=document.body.clientWidth;h=document.body.clientHeight;}
return{w:w,h:h};}
function resizeObjectToFullscreen(obj,objW,objH)
{var win=getWindowSize();var ratio=win.h/objH;if(objW*ratio>win.w){objH*=win.w/objW;objW=win.w;}else{objW*=win.h/objH;objH=win.h;}
objW=Math.floor(objW);objH=Math.floor(objH);obj.style.width=objW+'px';obj.style.height=objH+'px';}
function getURLQueryParam(name)
{var query=document.location.search;var pl=name.length;var c1=0;if(query.charAt(1+pl)==='='&&query.substr(1,pl)===name)
{c1=2+pl;}
var i=c1>0?c1:1;while(i<query.length)
{if(query.charAt(i)==='&')
{if(c1>0)
{return query.substring(c1,i);}
if((i+pl+1)<query.length&&query.charAt(i+pl+1)==='='&&query.substr(i+1,pl)===name)
{c1=i+pl+2;}}
i++;}
return(c1>0)?query.substring(c1):null;}
function loadjscssfile(filename,filetype)
{var fileref;if(filetype==="js")
{fileref=document.createElement('script');fileref.setAttribute("type","text/javascript");fileref.setAttribute("src",filename);}
else if(filetype==="css")
{fileref=document.createElement("link");fileref.setAttribute("rel","stylesheet");fileref.setAttribute("type","text/css");fileref.setAttribute("href",filename);}
else{return false;}
return document.getElementsByTagName("head")[0].appendChild(fileref);}
function relativeToAbsolutePath(abs,rel)
{var io=abs.indexOf('?');if(io===-1){io=abs.length;}
if(abs.charAt(io)==='/'){io--;}
abs=abs.substring(0,io);abs=abs.substring(0,abs.lastIndexOf('/'));var regex=/^\.\./;while(regex.test(rel))
{abs=abs.substring(0,abs.lastIndexOf('/'));rel=rel.substring(3);}
return abs+'/'+rel;}
return{isIE:isIE,isOffline:function(){return isOffline();},fireEvent:function(el,evt){return fireEvent(el,evt);},iframebuster:function(id){iframebuster(id);},getUniqueLocalConnectionId:function(){return getUniqueLocalConnectionId();},getFlash:function(id){return getFlash(id);},getFrame:function(id){return getFrame(id);},cachebuster:function(){return cachebuster();},changeCSS:function(className,element,value){changeCSS(className,element,value);},xdr:function(){return xdr();},xhr:function(){return xhr();},runTransform:function(xmlFile,xslFile,xDoc){runTransform(xmlFile,xslFile,xDoc);},addEvent:function(obj,type,fn){addEvent(obj,type,fn);},removeEvent:function(obj,type,fn){removeEvent(obj,type,fn);},addWindowEvent:function(strEvent,oFunction,bCapture){addWindowEvent(strEvent,oFunction,bCapture);},getMouseXY:function(e){return getMouseXY(e);},getElementPosX:function(obj){return getElementPosX(obj);},getElementPosY:function(obj){return getElementPosY(obj);},openWin:function(page,name,prop){return openWin(page,name,prop);},getWindowSize:function(){return getWindowSize();},resizeObjectToFullscreen:function(obj,objW,objH){resizeObjectToFullscreen(obj,objW,objH);},getURLQueryParam:function(name){return getURLQueryParam(name);},loadjscssfile:function(filename,filetype){return loadjscssfile(filename,filetype);},relativeToAbsolutePath:function(abs,rel){return relativeToAbsolutePath(abs,rel);}};}());